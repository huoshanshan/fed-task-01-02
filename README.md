# fed-task-01-02

#简答题

1、描述引用计数的工作原理和优缺点

引用计数的工作原理：核心思想设置引用数，判断当前引用数市口为0来判断是不是垃圾，为0的时候GC就开始工作，将其所在的内存空间释放回收再利用，引用计数器，引用关系发生改变时修改引用数字，每次引用计数器加一，减少引用的时候计数器减一，直到计数器变为0立即回收

优点：
1、发现垃圾时立即回收
2、最大限度减少程序暂停

缺点：
1、无法回收循环引用
2、时间开销大，有大量的对象需要修改耗时较长

循环引用

function fn() {
    const obj1 = {}
    const obj2 = {}

    obj1.name = obj2
    obj2.name = obj1

    return "srting"
}

fn()

fn调用完成时obj1、obj2本来应该回收的，但是被obj1.name和 obj2.name 循环引用导致无法回收

2、描述标记整理算法的工作流程

标记整理可以看作是标记清楚的增强
标记阶段的操作和标记清楚一致遍历所有对象将当前可达活动对象标记
清除阶段会先执行整理，移动对象的位置，将没有标记的对象进行回收，变成连续的空间，共后期使用

3、描述V8中新生代存储区垃圾回收的流程。

新生代：
V8内存空间一分为二（新生代和老生代）
小空间用于存储新生代对象（64位操作系统内存32M，32位操作系统内存16M）
新生代指的是存活时间较短的对象（局部变量）

回收流程：
回收过程采用复制算法和标记整理
新生代内存去分为两个等大的小空间（from和to）
使用空间为from，空闲空间为to
所有的活动对象都存储在from空间
from空间运用到一定程度后V8就会进行标记整理将活动对象拷贝到to空间
from与to交换空间完成后就可以释放了，因为活动的对象已经备份到to空间中了
from拷贝到to的过程中可能出现晋升
晋升就是将新生代对象移动到老生代
一轮GC后还存活的新生代或者to空间使用率超过25%都会发生晋升



4、描述增量标记算法在何时使用，及工作原理。

老生代对象（全局变量、闭包，存活时间较长的对象）垃圾回收时使用
垃圾回收会阻塞js程序执行
增量标记就是把整个垃圾回收过程拆分成多个小段组合完成回收，执行一段程序，遍历对象进行标记，垃圾回收和程序执行交替完成，
第一步找到直接可达对象就可以停下来让程序执行一会，然后第二步的标记间接可达对象，然后再让程序执行，标记完成后进行清除操作，完成清除后在让程序执行